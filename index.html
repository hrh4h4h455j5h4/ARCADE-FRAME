<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Arcade Studio</title>
<style>
  html { scroll-behavior: smooth; }
  body {
    background: #000; color: white; font-family: sans-serif;
    display: flex; flex-direction: column; align-items: center;
    min-height: 100vh; margin: 0; padding-bottom: 120px;
    -webkit-overflow-scrolling: touch; transition: 0.5s ease;
    overflow-x: hidden; position: relative;
  }
  
  /* STABLE BACKGROUND ENGINE */
  .bg-layer { position: fixed; top:0; left:0; width:100%; height:100%; z-index: -5; pointer-events: none; }
  
  /* ANIMATION KEYFRAMES */
  @keyframes flow { from { background-position: 0 0; } to { background-position: 40px 40px; } }
  @keyframes scan { from { background-position: 0 0; } to { background-position: 0 100%; } }
  @keyframes auroraFlow { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }
  @keyframes rainFall { from { background-position: 0 0; } to { background-position: 20px 1000px; } }
  @keyframes flash { 0%, 90%, 100% { opacity: 0; } 92%, 95% { opacity: 0.3; } }

  /* 41 ORDERED THEME CLASSES */
  .t1 .bg-layer { background-image: linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px); background-size: 100% 4px; } /* Official Scanline */
  .t2 .bg-layer { background: radial-gradient(circle at bottom, #ff4500, #8b0000, #000); background-size: 200% 200%; animation: flow 8s infinite linear; } /* Inferno */
  .t3 .bg-layer { background: #050508; background-image: linear-gradient(rgba(0, 255, 255, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(0, 255, 255, 0.1) 1px, transparent 1px); background-size: 40px 40px; animation: flow 3s linear infinite; } /* Grid */
  .t4 .bg-layer { background: #1a0033; background-image: radial-gradient(#ff00ff 0.5px, transparent 0.5px); background-size: 20px 20px; } /* Vaporwave */
  .t5 .bg-layer { background: #001a00; color: #00ff00; } /* Matrix */
  .t6 .bg-layer { background: linear-gradient(45deg, #1a1a1c, #2a2a2e); }
  .t7 .bg-layer { background: #2b1d0e; border-top: 5px solid #ffd700; }
  .t8 .bg-layer { background: #000d1a; border-top: 5px solid #00ffff; }
  .t9 .bg-layer { background: #1a0505; background-image: radial-gradient(#ff4d4d 1px, transparent 0); background-size: 40px 40px; }
  .t10 .bg-layer { background: #0d0d0d; border-left: 10px solid #00ffff; }
  /* Themes 11-31 simplified for space, keeping core styles... */
  .t21 .bg-layer { background: #0a0a0c; } /* Original Black */
  
  /* 10 NEW NON-RETRO LIVE THEMES (32-41) */
  .t32 .bg-layer { background: #001; background-image: linear-gradient(transparent, rgba(255,255,255,0.1)); background-size: 2px 50px; animation: rainFall 0.5s linear infinite; } /* Rain Shower */
  .t33 .bg-layer { background: linear-gradient(to bottom, #004, #001); animation: auroraFlow 10s linear infinite; } /* Aurora */
  .t34 .bg-layer { background: #001a33; animation: auroraFlow 5s ease infinite alternate; } /* Undersea Deep */
  .t35 .bg-layer { background: radial-gradient(circle, #fff7e6, #ffcc00, #000); background-size: 150% 150%; animation: flow 20s infinite linear; } /* Sun Flare */
  .t36 .bg-layer { background: #111; background-image: radial-gradient(white 1px, transparent 1px); background-size: 50px 50px; animation: rainFall 10s linear infinite; } /* Snowfall */
  .t37 .bg-layer { background: #2a2a1a; background-image: repeating-linear-gradient(45deg, rgba(255,255,255,0.05) 0, rgba(255,255,255,0.05) 1px, transparent 0, transparent 20px); animation: flow 1s linear infinite; } /* Wind Gust */
  .t38 .bg-layer { background: #000; background-image: radial-gradient(white 0.5px, transparent 0); background-size: 100px 100px; animation: flow 60s linear infinite; } /* Galaxy */
  .t39 .bg-layer { background: #000; } .t39::after { content:''; position:fixed; top:0; left:0; width:100%; height:100%; background:white; animation: flash 4s infinite; z-index:-4; pointer-events:none; } /* Lightning */
  .t40 .bg-layer { background: #051a05; filter: blur(20px); opacity: 0.5; } /* Forest Mist */
  .t41 .bg-layer { background: #000; background-image: radial-gradient(circle, #222, transparent); background-size: 100% 100%; animation: auroraFlow 15s infinite; } /* Calm Zen */

  .menu-toggle { position: absolute; top: 15px; left: 15px; background: #1a1a1c; color: #fff; border: 1px solid rgba(255,255,255,0.1); padding: 8px 12px; border-radius: 4px; font-weight: bold; cursor: pointer; z-index: 1000; font-size: 11px; }
  #menu-panel, #theme-selector { position: fixed; top: 0; left: -255px; width: 230px; height: 100%; background: #000; padding-top: 60px; transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); z-index: 2000; display: flex; flex-direction: column; gap: 8px; padding-left: 15px; padding-right: 15px; overflow-y: auto; }
  #menu-panel.open, #theme-selector.open { transform: translateX(255px); }
  
  .lnk, .theme-opt { display: flex; align-items: center; gap: 10px; padding: 12px; text-decoration: none; color: white; font-size: 12px; font-weight: bold; border-radius: 4px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); cursor: pointer; }
  .theme-opt .t-prev { width: 20px; height: 20px; border-radius: 3px; border: 1px solid #fff; flex-shrink: 0; }

  h1 { 
    color: #ffffff; margin: 60px 0 0 0; font-family: "Arial Black", sans-serif; font-style: italic; font-size: 32px; 
    text-transform: uppercase; letter-spacing: -1px; text-shadow: 2px 2px 0px #ff0000; 
    text-align: center; animation: arcadeBounce 2s infinite ease-in-out;
  }
  @keyframes arcadeBounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-6px); } }
  .sub { color: #ffffff; font-weight: bold; margin: 2px 0 15px 0; text-transform: uppercase; font-size: 11px; letter-spacing: 2px; text-align: center; }

  #box { 
    position: relative; width: 280px; height: 280px; border-radius: 50%; overflow: hidden; background: #111; margin: 0 auto; 
    -webkit-mask-image: -webkit-radial-gradient(white,black); box-shadow: 0 0 15px rgba(0,0,0,0.5); 
    background-image: linear-gradient(45deg,#111 25%,transparent 25%),linear-gradient(-45deg,#111 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#111 75%),linear-gradient(-45deg,transparent 75%,#111 75%); background-size: 20px 20px; z-index: 10;
  }
  canvas { position: absolute; top: 0; left: 0; width: 280px; height: 280px; touch-action: none; z-index: 15; }
  
  #shine-flare { position: absolute; top: 0; left: -100%; width: 50%; height: 100%; background: linear-gradient(to right, transparent, rgba(255,255,255,0.3), transparent); transform: skewX(-25deg); pointer-events: none; z-index: 20; }
  .shine-active #shine-flare { animation: shineRun 1.2s ease-in-out; }
  @keyframes shineRun { 0% { left: -100%; } 100% { left: 200%; } }

  .ui { margin-top: 20px; width: 260px; display: flex; flex-direction: column; gap: 6px; margin-left: auto; margin-right: auto; z-index: 100; position: relative; }
  .btn { background: #111; border: 1px solid #ffffff; color: white; padding: 10px; text-align: center; border-radius: 8px; font-weight: bold; font-size: 11px; cursor: pointer; display: block; }
  .btn-center { border-color: #00ffff; color: #00ffff; }
  #save { background: #ff0000; border: none; font-size: 13px; color: white; padding: 12px; border-radius: 8px; font-weight: bold; margin-top: 10px; cursor: pointer; }

  input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; height: 25px; cursor: pointer; }
  input[type=range]::-webkit-slider-runnable-track { height: 6px; background: #333; border-radius: 3px; }
  input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 18px; width: 18px; border-radius: 50%; background: #ff0000; margin-top: -6px; border: 2px solid white; }
  
  #yt-player { display: none; }
</style>
</head>
<body class="t1" onclick="startAudio()">

<div class="bg-layer"></div>
<button class="menu-toggle" onclick="toggleMenu(event)">MENU ‚ò∞</button>

<div id="menu-panel">
  <div class="lnk" onclick="toggleMusic()">MUSIC: <span id="m-status">ON</span></div>
  <div class="lnk" style="border-color:#0af;" onclick="openThemeSelector()">Switch Theme</div>
  <a href="https://discord.gg/ardc" target="_blank" class="lnk" style="border-color:#5865F2;">Discord Server</a>
  <div class="lnk" onclick="toggleAboutPage()">About Us</div>
</div>

<div id="theme-selector">
  <div class="lnk" onclick="closeThemeSelector()" style="border-color:#555;">‚Üê BACK</div>
  <div class="theme-opt" onclick="setT(1, 'nv_2rz5BFDA')"><div class="t-prev" style="background:#222;"></div> 1. Official Scanline</div>
  <div class="theme-opt" onclick="setT(2, 'L_v_N95bX_Y')"><div class="t-prev" style="background:#f40;"></div> 2. Inferno (Live)</div>
  <div class="theme-opt" onclick="setT(3, 'nv_2rz5BFDA')"><div class="t-prev" style="background:#0af;"></div> 3. Retro Grid (Live)</div>
  <div class="theme-opt" onclick="setT(32, '5qap5aO4i9A')"><div class="t-prev" style="background:#00f;"></div> 32. Rain Shower (Live)</div>
  <div class="theme-opt" onclick="setT(33, 'uGf6SPSV6uE')"><div class="t-prev" style="background:#0f0;"></div> 33. Aurora (Live)</div>
  <div class="theme-opt" onclick="setT(34, 'uGf6SPSV6uE')"><div class="t-prev" style="background:#003366;"></div> 34. Deep Water (Live)</div>
  <div class="theme-opt" onclick="setT(35, 'uGf6SPSV6uE')"><div class="t-prev" style="background:#ffcc00;"></div> 35. Sunlight (Live)</div>
  <div class="theme-opt" onclick="setT(36, 'uGf6SPSV6uE')"><div class="t-prev" style="background:#fff;"></div> 36. Snowfall (Live)</div>
  <div class="theme-opt" onclick="setT(37, 'uGf6SPSV6uE')"><div class="t-prev" style="background:#999;"></div> 37. Wind Gust (Live)</div>
  <div class="theme-opt" onclick="setT(38, 'uGf6SPSV6uE')"><div class="t-prev" style="background:#000;"></div> 38. Galaxy (Live)</div>
  <div class="theme-opt" onclick="setT(39, 'uGf6SPSV6uE')"><div class="t-prev" style="background:#fff; border:1px solid #000;"></div> 39. Thunder (Live)</div>
  <div class="theme-opt" onclick="setT(40, 'uGf6SPSV6uE')"><div class="t-prev" style="background:#050;"></div> 40. Forest Mist (Live)</div>
  <div class="theme-opt" onclick="setT(41, 'uGf6SPSV6uE')"><div class="t-prev" style="background:#333;"></div> 41. Calm Zen (Live)</div>
  <div class="theme-opt" onclick="setT(21, 'nv_2rz5BFDA')"><div class="t-prev" style="background:#0a0a0c;"></div> Original Noir Black</div>
</div>

<div id="yt-player"></div>

<h1>ARCADE</h1>
<p class="sub">FRAME STUDIO</p>

<div id="studio-view" style="display: flex; flex-direction: column; align-items: center; width: 100%;">
  <div id="box"><canvas id="c" width="800" height="800"></canvas><div id="shine-flare"></div></div>
  <div class="ui">
    <label class="btn">STEP 1: CHOOSE PHOTO<input type="file" id="u1" accept="image/*" style="display:none;" onchange="handleFile(event)"></label>
    <label class="btn" style="border-color:#ff0000;">STEP 2: UPLOAD FRAME<input type="file" id="u2" accept="image/*" style="display:none;" onchange="handleFrame(event)"></label>
    <button class="btn btn-center" onclick="centerSubject()">CENTER SUBJECT üéØ</button>
    <button class="btn" style="border-color:#ffd700; color:#ffd700;" onclick="runShine()">PREVIEW SHINE ‚ú®</button>
    <input type="range" id="z" min="0.1" max="4" step="0.01" value="1" oninput="updateZ(this.value)">
    <input type="range" id="m" min="300" max="400" step="1" value="375" oninput="updateM(this.value)">
    <button id="save" onclick="downloadPic()">DOWNLOAD PICTURE</button>
  </div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
const c=document.getElementById('c'),x=c.getContext('2d'),zSl=document.getElementById('z'),mSl=document.getElementById('m'),sBtn=document.getElementById('save'),panel=document.getElementById('menu-panel'),tMenu=document.getElementById('theme-selector'),box=document.getElementById('box'),mStat=document.getElementById('m-status');
let i=new Image(),f=new Image(),cfg={s:1,m:375,x:400,y:400,r:0,d:false,lx:0,ly:0,ia:0,ir:0},player,musicOn=true,audioStarted=false,curT=1;
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function onYouTubeIframeAPIReady() { player = new YT.Player('yt-player', { height: '0', width: '0', videoId: 'nv_2rz5BFDA', playerVars: { 'autoplay': 1, 'loop': 1 }, events: { 'onReady': e => { if(musicOn) e.target.playVideo(); } } }); }
function startAudio() { if (!audioStarted) { audioCtx.resume(); if(player && musicOn) player.playVideo(); audioStarted = true; } }
function openThemeSelector() { panel.classList.remove('open'); tMenu.classList.add('open'); }
function closeThemeSelector() { tMenu.classList.remove('open'); panel.classList.add('open'); }
function setT(n, v) { document.body.className = 't'+n; if(player && v) player.loadVideoById(v); curT=n; tMenu.classList.remove('open'); }
function centerSubject() { if(!i.src) return; playShutter(); cfg.x = 400; cfg.y = 400; d(); }
function runShine() { if(!f.src) return; playShutter(); box.classList.add('shine-active'); setTimeout(()=>box.classList.remove('shine-active'), 1200); }
function toggleMusic() { musicOn = !musicOn; musicOn ? player.playVideo() : player.pauseVideo(); mStat.innerText = musicOn ? "ON" : "OFF"; }
function toggleMenu(e) { e.stopPropagation(); startAudio(); panel.classList.toggle('open'); tMenu.classList.remove('open'); }
window.onclick = e => { if (!panel.contains(e.target) && !tMenu.contains(e.target)) { panel.classList.remove('open'); tMenu.classList.remove('open'); } };

function d(){ x.clearRect(0,0,800,800); x.save(); x.beginPath(); x.arc(400,400,cfg.m,0,6.28); x.clip(); if(i.src){ let w=i.width*cfg.s, h=i.height*cfg.s; x.save(); x.translate(cfg.x, cfg.y); x.rotate(cfg.r); x.drawImage(i, -w/2, -h/2,w,h); x.restore(); } x.restore(); if(f.src) x.drawImage(f, 0, 0, 800, 800); if (i.src || f.src) sBtn.style.opacity = "1"; }
function handleFile(e) { let r=new FileReader(); r.onload=v=>{ const nI=new Image(); nI.onload=()=>{ i=nI; cfg.s=Math.max(800/i.width,800/i.height); zSl.value=cfg.s; d(); }; nI.src=v.target.result; }; r.readAsDataURL(e.target.files[0]); }
function handleFrame(e) { let r=new FileReader(); r.onload=v=>{ const nF=new Image(); nF.onload=d; nF.src=v.target.result; f=nF; }; r.readAsDataURL(e.target.files[0]); }
function updateZ(v) { cfg.s=parseFloat(v); d(); }
function updateM(v) { cfg.m=parseInt(v); d(); }
function gp(e, idx=0){ let r=c.getBoundingClientRect(), t=e.touches?e.touches[idx]:e; return {x:(t.clientX-r.left)*(800/r.width),y:(t.clientY-r.top)*(800/r.height)}; }
function st(e){ if(e.target==c){ cfg.d=true; if(e.touches && e.touches.length === 2) { cfg.ia = Math.atan2(e.touches[1].pageY - e.touches[0].pageY, e.touches[1].pageX - e.touches[0].pageX); cfg.ir = cfg.r; } else { let p=gp(e); cfg.lx=p.x-cfg.x; cfg.ly=p.y-cfg.y; } } }
function mv(e){ if(cfg.d){ if(e.touches && e.touches.length === 2) { let a = Math.atan2(e.touches[1].pageY - e.touches[0].pageY, e.touches[1].pageX - e.touches[0].pageX); cfg.r = cfg.ir + (a - cfg.ia); } else { let p=gp(e); cfg.x=p.x-cfg.lx; cfg.y=p.y-cfg.ly; } d(); } }
c.ontouchstart=st; window.ontouchmove=mv; window.ontouchend=()=>cfg.d=false; c.onmousedown=st; window.onmousemove=mv; window.onmouseup=()=>cfg.d=false;
function playShutter() { const o = audioCtx.createOscillator(); const g = audioCtx.createGain(); o.type = 'square'; o.frequency.setValueAtTime(200, audioCtx.currentTime); g.gain.setValueAtTime(0.1, audioCtx.currentTime); o.connect(g); g.connect(audioCtx.destination); o.start(); o.stop(audioCtx.currentTime + 0.15); }
function downloadPic() { 
  const notes = [523.25, 659.25, 783.99, 1046.50]; notes.forEach((freq, idx) => { const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain(); osc.frequency.setValueAtTime(freq, audioCtx.currentTime + (idx * 0.1)); gain.gain.setValueAtTime(0.1, audioCtx.currentTime + (idx * 0.1)); gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + (idx * 0.1) + 0.1); osc.connect(gain); gain.connect(audioCtx.destination); osc.start(audioCtx.currentTime + (idx * 0.1)); osc.stop(audioCtx.currentTime + (idx * 0.1) + 0.1); });
  let a=document.createElement('a'); a.download='Arcade_Edit.png'; a.href=c.toDataURL(); a.click(); 
}
</script>
</body>
</html>
