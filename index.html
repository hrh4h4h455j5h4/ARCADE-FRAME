<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Arcade Studio</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js"></script>

<style>
  /* =========================================
     1. GLOBAL & ARCADE FRAME STYLES
     ========================================= */
  html { scroll-behavior: smooth; overflow-y: auto; }
  body {
    background: #0a0a0c; color: white; font-family: sans-serif;
    display: flex; flex-direction: column; align-items: center;
    min-height: 100vh; margin: 0; padding-bottom: 150px; 
    -webkit-overflow-scrolling: touch; 
    background-image: linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px);
    background-size: 100% 4px; touch-action: pan-y; 
  }
  
  .menu-toggle { 
    position: fixed; top: 15px; left: 15px; 
    background: #1a1a1c; color: #fff; border: 1px solid rgba(255,255,255,0.1); 
    padding: 8px 12px; border-radius: 4px; font-weight: bold; cursor: pointer; 
    z-index: 100000; font-size: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.5); 
  }

  #menu-panel { 
    position: fixed; top: 0; left: -260px; width: 240px; height: 100%; 
    background: #1a1a1c; padding-top: 60px; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
    z-index: 99999; display: flex; flex-direction: column; gap: 15px; 
    padding-left: 15px; padding-right: 15px; box-shadow: 2px 0 15px rgba(0,0,0,0.5); 
    box-sizing: border-box; padding-bottom: 80px; 
  }
  #menu-panel.open { left: 0; }

  .switch-container { position: relative; width: 100%; }
  #switch-btn { 
    background: rgba(255,255,255,0.05); color: white; border: 2px solid #ff0000; 
    padding: 10px; border-radius: 4px; font-weight: bold; cursor: pointer; 
    font-size: 11px; text-transform: uppercase; width: 100%; text-align: center;
    box-shadow: 0 0 10px rgba(255,0,0,0.5); 
  }
  #switch-menu { 
    position: absolute; top: 45px; right: 0; background: #1a1a1c; 
    border: 1px solid #ff0000; border-radius: 8px; width: 210px; 
    display: none; flex-direction: column; overflow: hidden; 
    box-shadow: 0 10px 20px rgba(0,0,0,0.8); z-index: 100001;
  }
  #switch-menu button { 
    background: transparent; color: #aaa; border: none; padding: 14px; 
    text-align: left; font-weight: bold; font-size: 11px; cursor: pointer; 
    border-bottom: 1px solid rgba(255,255,255,0.05); text-transform: uppercase;
  }
  #switch-menu button.active-link { color: #00ffff; background: rgba(0,255,255,0.1); border-left: 3px solid #00ffff; }

  .designed-by { position: absolute; bottom: 0; left: 0; width: 100%; padding: 20px 0; border-top: 1px solid rgba(255,255,255,0.1); text-align: center; font-size: 11px; font-weight: 900; color: #888; background: #1a1a1c; }
  .designed-by b { color: #ff0000; text-shadow: 0 0 8px rgba(255,0,0,0.6); }

  .music-section { border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.03); border-radius: 6px; padding: 10px; display: flex; flex-direction: column; gap: 8px; }
  .lnk { display: flex; align-items: center; gap: 10px; padding: 12px; text-decoration: none; color: white; font-size: 13px; font-weight: bold; border-radius: 4px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); }

  h1 { color: #fff; margin: 60px 0 0 0; font-family: "Arial Black", sans-serif; font-style: italic; font-size: 36px; text-transform: uppercase; letter-spacing: -1px; text-shadow: 2px 2px 0px #ff0000, -1px -1px 10px rgba(255, 0, 0, 0.8); animation: arcadeBounce 1.8s infinite ease-in-out; }
  @keyframes arcadeBounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
  .sub { color: #fff; font-weight: bold; margin: 2px 0 15px 0; text-transform: uppercase; font-size: 11px; letter-spacing: 2px; text-align: center; }
  
  .studio-sec { display: none; width: 320px; flex-direction: column; align-items: center; }
  .active-sec { display: flex; }

  /* --- üñºÔ∏è FRAME STUDIO (ORIGINAL) --- */
  #box { 
    position: relative; width: 310px; height: 310px; border-radius: 50%; overflow: hidden; 
    border: 3px solid #ff0000; box-sizing: border-box; background-color: transparent; background-size: 20px 20px;
    box-shadow: 0 0 20px rgba(0,0,0,0.5); z-index: 10; 
  }
  canvas#c { position: absolute; top: 0; left: 0; width: 310px; height: 310px; z-index: 15; touch-action: none; }
  
  /* UI / SLIDERS */
  .ui { margin-top: 20px; width: 310px; display: flex; flex-direction: column; gap: 6px; }
  .btn { background: #111; border: 2px solid #ffffff; color: white; padding: 10px; text-align: center; border-radius: 8px; font-weight: bold; display: block; font-size: 12px; cursor: pointer; text-transform: uppercase; }
  .btn-r { border-color: #ff0000; }
  .lbl { font-size: 9px; color: #888; text-transform: uppercase; margin-top: 2px; display: flex; justify-content: space-between; align-items: center; width: 100%; }
  .val-tag { color: #ff0000; font-weight: bold; font-family: monospace; font-size: 10px; }
  input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; margin: 10px 0; cursor: pointer; }
  input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 8px; background: linear-gradient(to right, #ff0000 var(--v, 0%), #00ffff var(--v, 0%)); border-radius: 4px; }
  input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 20px; width: 20px; border-radius: 50%; background: #ff0000; margin-top: -6px; border: 2px solid #ffffff; box-shadow: 0 0 10px #ff0000; }
  #save { background: #ff0000; border: none; font-size: 14px; color: white; padding: 12px; border-radius: 8px; font-weight: bold; margin-top: 10px; cursor: pointer; text-transform: uppercase; }

  /* =========================================
     2. NEON GIF STUDIO (SPEED OPTIMIZED)
     ========================================= */
  :root { --neon: #00f3ff; --purple: #bc13fe; }
  .stage { position: relative; width: 320px; height: 320px; display: flex; align-items: center; justify-content: center; margin-bottom: 30px; touch-action: none; }
  .led-ring { position: absolute; inset: -15px; border-radius: 50%; background: conic-gradient(from 0deg, transparent, var(--neon), var(--purple), transparent); animation: rotate 2s linear infinite; filter: blur(20px); z-index: 1; pointer-events: none; }
  .viewport { position: relative; z-index: 5; width: 100%; height: 100%; border-radius: 50%; overflow: hidden; background-color: #000; background-size: 20px 20px; box-shadow: inset 0 0 20px #000; touch-action: none; }
  #v { position: absolute; top: 0; left: 0; min-width: 100%; min-height: 100%; transform-origin: top left; pointer-events: none; }
  #o { width: 100%; height: 100%; object-fit: cover; display: none; }
  @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

  .ui-neon { z-index: 10; background: rgba(10, 10, 10, 0.9); backdrop-filter: blur(20px); padding: 25px; border-radius: 30px; width: 340px; border: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; align-items: center; }
  .btn-upload { background: linear-gradient(90deg, var(--neon), var(--purple)); color: #000; border: none; padding: 15px; border-radius: 50px; font-weight: 800; cursor: pointer; width: 100%; margin-bottom: 25px; font-size: 14px; }
  .label-row { display: flex; justify-content: space-between; font-size: 11px; color: #888; margin-bottom: 8px; width: 100%; }

  /* GIF SLIDERS FORCE BLUE */
  #gif-studio input[type="range"] { -webkit-appearance: none; background: transparent; width: 100%; margin-bottom: 25px; }
  #gif-studio input[type="range"]::-webkit-slider-runnable-track { background: #333; height: 6px; border-radius: 3px; }
  #gif-studio input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; background: var(--neon); box-shadow: 0 0 10px var(--neon); width: 20px; height: 20px; margin-top: -7px; border-radius: 50%; }

  .btn-go { background: transparent; color: white; border: 1px solid var(--neon); padding: 15px; width: 100%; border-radius: 15px; cursor: pointer; font-weight: bold; font-size: 14px; }
  .status { margin-top: 20px; font-size: 14px; color: var(--neon); font-weight: 600; opacity: 0; height: 20px; }
  .status.active { opacity: 1; }
  .neon-wrap { position: relative; display: none; margin-top: 20px; padding: 3px; border-radius: 50px; overflow: hidden; }
  .neon-wrap.blue::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: conic-gradient(transparent, transparent, var(--neon), var(--purple), transparent, transparent); animation: rotate 2s linear infinite; }
  .btn-inner { position: relative; display: block; text-decoration: none; text-align: center; color: white; background: #000; padding: 12px 30px; border-radius: 48px; font-weight: 900; font-size: 14px; z-index: 1; cursor: pointer; }
</style>
</head>
<body onclick="startAudio()">

<button class="menu-toggle" onclick="toggleMenu(event)">MENU ‚ò∞</button>

<div id="menu-panel">
  <div class="switch-container">
    <button id="switch-btn" onclick="toggleSwitchMenu(event)">SWITCH TO üìÇ</button>
    <div id="switch-menu">
      <button id="nav-frame" class="active-link" onclick="changeStudio('frame')">üñºÔ∏è Frame Studio</button>
      <button id="nav-font" onclick="changeStudio('font')">‚úçÔ∏è Font Generator</button>
      <button id="nav-gif" onclick="changeStudio('gif')">‚ö° GIF Maker</button>
    </div>
  </div>

  <div class="music-section">
    <div class="music-btn" style="display:flex; justify-content:space-between; font-size:12px; font-weight:bold; cursor:pointer;" onclick="toggleMusic()">
      <span>MUSIC PLAYER</span> <span id="m-status" style="color:#ff0000;">ON</span>
    </div>
    <select class="station-select" style="width:100%; margin-top:5px;" onchange="changeMusic(this.value)">
      <option value="jfKfPfyJRdk" selected>‚òï Lofi Focus</option>
      <option value="nv_2rz5BFDA">üïπÔ∏è Retro Wave</option>
    </select>
  </div>
  <a href="https://discord.gg/ardc" target="_blank" class="lnk" style="border-color:#5865F2;"><span>Discord Server</span></a>
  <div class="designed-by">DESIGNED BY <b>RISK</b></div>
</div>

<div id="yt-player"></div>

<h1 id="studio-name">ARCADE</h1>
<p class="sub" id="studio-sub">FRAME STUDIO</p>

<div id="frame-studio" class="studio-sec active-sec">
  <div id="box"><canvas id="c" width="800" height="800"></canvas></div>
  <div class="ui">
    <label class="btn" onclick="playClick()">CHOOSE IMAGE<input type="file" id="u1" accept="image/*" onchange="handleFile(event)" style="display:none"></label>
    <label class="btn btn-r" onclick="playClick()">APPLY FRAME<input type="file" id="u2" accept="image/*" onchange="handleFrame(event)" style="display:none"></label>
    <button class="btn" style="border-color:#00ffff;" onclick="centerSubject()">CENTER SUBJECT üéØ</button>
    
    <div class="lbl">ZOOM <span id="z-val" class="val-tag">100%</span></div>
    <input type="range" id="z" min="0.1" max="4" step="0.01" value="1" oninput="updateZ(this.value)">
    <div class="lbl">ROTATE <span id="r-val" class="val-tag">0¬∞</span></div>
    <input type="range" id="r" min="0" max="360" step="1" value="0" oninput="updateR(this.value)">
    
    <button id="save" onclick="downloadPic()">DOWNLOAD PICTURE</button>
  </div>
</div>

<div id="font-studio" class="studio-sec">
  <input type="text" id="font-input" class="font-input" placeholder="Type here..." oninput="genFonts()">
  <div id="font-results" class="font-scroll"></div>
</div>

<div id="gif-studio" class="studio-sec">
    <div class="stage">
        <div class="led-ring"></div>
        <div class="viewport" id="vp">
            <video id="v" muted playsinline loop></video>
            <img id="o">
        </div>
    </div>
    <div class="ui-neon">
        <button class="btn-upload" id="upBtn" onclick="document.getElementById('gifF').click()">UPLOAD VIDEO</button>
        <input type="file" id="gifF" accept="video/*" style="display:none">

        <div class="label-row"><span>ZOOM</span><span id="zv">100%</span></div>
        <input type="range" id="zoom" min="100" max="300" value="100">

        <div class="label-row"><span>SPEED</span><span id="sv">1.0x</span></div>
        <input type="range" id="speed" min="0.5" max="3.0" step="0.1" value="1.0">

        <button id="go" class="btn-go">‚ö° CREATE HD GIF</button>
        <div id="msg" class="status">Processing...</div>
        <div id="dlBox" class="neon-wrap blue"><a id="dl" class="btn-inner">‚¨áÔ∏è DOWNLOAD GIF</a></div>
    </div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
// --- NAVIGATION ---
const sName=document.getElementById('studio-name'), sSub=document.getElementById('studio-sub'), swMenu=document.getElementById('switch-menu'), panel=document.getElementById('menu-panel');
function toggleMenu(e){ e.stopPropagation(); panel.classList.toggle('open'); swMenu.style.display='none'; }
function toggleSwitchMenu(e){ e.stopPropagation(); swMenu.style.display=swMenu.style.display==='flex'?'none':'flex'; }

function changeStudio(mode){
  document.querySelectorAll('.studio-sec').forEach(s=>s.classList.remove('active-sec'));
  swMenu.style.display='none'; panel.classList.remove('open');
  if(mode==='frame'){ document.getElementById('frame-studio').classList.add('active-sec'); sName.innerText="ARCADE"; sSub.innerText="FRAME STUDIO"; }
  else if(mode==='font'){ document.getElementById('font-studio').classList.add('active-sec'); sName.innerText="FONTS"; sSub.innerText="GENERATOR STUDIO"; }
  else if(mode==='gif'){ document.getElementById('gif-studio').classList.add('active-sec'); sName.innerText="NEON"; sSub.innerText="GIF STUDIO"; }
}

// --- TURBO GIF LOGIC ---
const workerBlob = new Blob([`importScripts('https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.worker.js');`], {type:'application/javascript'});
const workerUrl = URL.createObjectURL(workerBlob);
const gifF=document.getElementById('gifF'), v=document.getElementById('v'), o=document.getElementById('o'), vp=document.getElementById('vp'), dlBox=document.getElementById('dlBox'), dl=document.getElementById('dl'), msg=document.getElementById('msg'), go=document.getElementById('go');

gifF.onchange=(e)=>{ const file=e.target.files[0]; v.style.display='block'; o.style.display='none'; dlBox.style.display='none'; v.src=URL.createObjectURL(file); v.play(); };

go.onclick=()=>{
    if(!v.src) return;
    msg.innerText="Turbo Processing..."; msg.classList.add('active');
    // QUALITY 20 = 2X SPEED
    const gif = new GIF({ workers:2, quality:20, width:480, height:480, workerScript:workerUrl });
    const canvas=document.createElement('canvas'); canvas.width=480; canvas.height=480; const ctx=canvas.getContext('2d');
    const fps=18, duration=v.duration; // 18FPS = Perfect Balance of speed/smoothness
    let cTime=0;
    const capture=()=>{
        if(cTime>=duration){ msg.innerText="Final Encoding..."; gif.render(); return; }
        v.currentTime=cTime;
        ctx.drawImage(v, 0, 0, 480, 480);
        gif.addFrame(ctx, {copy:true, delay: 1000/fps});
        cTime += 1/fps; capture();
    };
    gif.on('finished', (blob)=>{
        o.src=URL.createObjectURL(blob); v.style.display='none'; o.style.display='block';
        dl.href=o.src; dl.download="neon_arcade.gif"; dlBox.style.display='block';
        msg.classList.remove('active'); go.style.display='none';
    });
    capture();
};

// --- RESTORED ARCADE LOGIC ---
const c=document.getElementById('c'), x=c.getContext('2d');
let i=new Image(), f=new Image(), cfg={s:1,m:375,x:400,y:400,r:0}, audioStarted=false;
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function handleFile(e){ let r=new FileReader(); r.onload=v=>{ let n=new Image(); n.onload=()=>{i=n; d();}; n.src=v.target.result; }; r.readAsDataURL(e.target.files[0]); }
function handleFrame(e){ let r=new FileReader(); r.onload=v=>{ let n=new Image(); n.onload=()=>{f=n; d();}; n.src=v.target.result; }; r.readAsDataURL(e.target.files[0]); }
function d(){ x.clearRect(0,0,800,800); x.save(); x.beginPath(); x.arc(400,400,cfg.m,0,6.28); x.clip(); if(i.src) x.drawImage(i,0,0,800,800); x.restore(); if(f.src) x.drawImage(f,0,0,800,800); }
function updateZ(v){ cfg.s=v; d(); }
function updateR(v){ cfg.r=v; d(); }
function centerSubject(){ cfg.x=400; cfg.y=400; d(); }
function startAudio(){ if(!audioStarted){ audioCtx.resume(); audioStarted=true; } }
function playClick(){ /* Sound Logic */ }
function downloadPic(){ let a=document.createElement('a'); a.download="Arcade.png"; a.href=c.toDataURL(); a.click(); }
</script>
</body>
</html>
