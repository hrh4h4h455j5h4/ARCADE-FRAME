<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Arcade Studio</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js"></script>

<style>
  /* --- GLOBAL SETTINGS --- */
  html { scroll-behavior: smooth; overflow-y: auto; }
  body {
    background: #0a0a0c; color: white; font-family: sans-serif;
    display: flex; flex-direction: column; align-items: center;
    min-height: 100vh; margin: 0; padding-bottom: 150px; 
    -webkit-overflow-scrolling: touch; 
    background-image: linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px);
    background-size: 100% 4px; touch-action: pan-y; overflow-x: hidden;
  }

  /* --- NEON CLOCK --- */
  #arcade-clock {
    margin-top: 15px; font-family: monospace; font-size: 24px; font-weight: bold;
    color: #ff0000; text-shadow: 0 0 10px #ff0000;
    background: rgba(255, 0, 0, 0.05); padding: 5px 15px; border-radius: 4px;
    border: 1px solid rgba(255, 0, 0, 0.3); z-index: 1000;
  }

  /* --- VISUAL FX (RIPPLE ONLY) --- */
  .ripple { position: fixed; border: 2px solid #ff0000; border-radius: 50%; transform: scale(0); animation: rippleEffect 0.5s linear; pointer-events: none; z-index: 999999; }
  @keyframes rippleEffect { to { transform: scale(3.5); opacity: 0; } }

  /* --- ABOUT OVERLAY --- */
  #about-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 200000; display: none; align-items: center; justify-content: center; padding: 20px; }
  .about-content { background: #1a1a1c; border: 2px solid #00ffff; border-radius: 15px; padding: 30px; max-width: 500px; line-height: 1.6; position: relative; box-shadow: 0 0 30px rgba(0,255,255,0.3); }
  .about-content h2 { color: #00ffff; margin-top: 0; }
  .close-about { position: absolute; top: 15px; right: 15px; cursor: pointer; color: #888; font-size: 20px; }

  /* --- NAVIGATION --- */
  .menu-toggle { position: fixed; top: 15px; left: 15px; background: #1a1a1c; color: #fff; border: 1px solid rgba(255,255,255,0.1); padding: 8px 12px; border-radius: 4px; font-weight: bold; cursor: pointer; z-index: 100000; }
  #view-toggle { position: fixed; top: 15px; right: 15px; background: #1a1a1c; border: 1px solid #00ffff; padding: 8px 12px; border-radius: 4px; z-index: 100000; cursor: pointer; }

  #menu-panel { 
    position: fixed; top: 0; left: -260px; width: 240px; height: 100%; 
    background: #1a1a1c; padding-top: 60px; transition: 0.3s ease; 
    z-index: 99999; display: flex; flex-direction: column; gap: 12px; 
    padding-left: 15px; padding-right: 15px; box-sizing: border-box; padding-bottom: 20px; 
    box-shadow: 2px 0 15px rgba(0,0,0,0.5);
  }
  #menu-panel.open { left: 0; }

  .menu-section { border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.03); border-radius: 6px; padding: 10px; display: flex; flex-direction: column; gap: 5px; }
  .menu-lbl { font-size: 10px; font-weight: 900; color: #00ffff; text-transform: uppercase; }

  .switch-container { position: relative; width: 100%; }
  #switch-btn { background: rgba(255,255,255,0.05); color: white; border: 2px solid #ff0000; padding: 10px; border-radius: 4px; font-weight: bold; cursor: pointer; font-size: 11px; width: 100%; text-align: center; }
  #switch-menu { position: absolute; top: 45px; left: 0; background: #1a1a1c; border: 1px solid #ff0000; border-radius: 8px; width: 100%; display: none; flex-direction: column; z-index: 100001; }
  #switch-menu button { background: transparent; color: #aaa; border: none; padding: 12px; text-align: left; font-size: 11px; cursor: pointer; border-bottom: 1px solid rgba(255,255,255,0.05); }

  .lnk { display: flex; align-items: center; gap: 10px; padding: 12px; text-decoration: none; color: white; font-size: 13px; font-weight: bold; border-radius: 4px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); }
  .lnk svg { width: 18px; height: 18px; fill: white; }
  .designed-by { margin-top: auto; padding: 20px 0; border-top: 1px solid rgba(255,255,255,0.1); text-align: center; font-size: 11px; color: #888; text-transform: uppercase; }
  .designed-by b { color: #ff0000; }

  /* --- HEADERS --- */
  h1 { color: #fff; margin: 20px 0 0 0; font-family: "Arial Black", sans-serif; font-style: italic; font-size: 36px; text-shadow: 2px 2px 0px #ff0000; animation: arcadeBounce 1.8s infinite ease-in-out; }
  @keyframes arcadeBounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
  .sub { font-weight: bold; margin-bottom: 15px; font-size: 11px; letter-spacing: 2px; text-align: center; }
  
  .studio-sec { display: none; width: 320px; flex-direction: column; align-items: center; }
  .active-sec { display: flex; }

  /* --- FRAME STUDIO (RESTORED BACKGROUND) --- */
  @keyframes neonPulse {
    0% { box-shadow: 0 0 20px #ff0000, inset 0 0 10px #ff0000; border-color: #ff0000; }
    50% { box-shadow: 0 0 35px #ff0000, inset 0 0 20px #ff0000; border-color: #ff3333; }
    100% { box-shadow: 0 0 20px #ff0000, inset 0 0 10px #ff0000; border-color: #ff0000; }
  }
  #box { 
    position: relative; width: 310px; height: 310px; border-radius: 50%; overflow: hidden; 
    border: 3px solid #ff0000; box-sizing: border-box; 
    /* RESTORED CHECKERED PATTERN */
    background-image: linear-gradient(45deg, #1a1a1c 25%, transparent 25%), linear-gradient(-45deg, #1a1a1c 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #1a1a1c 75%), linear-gradient(-45deg, transparent 75%, #1a1a1c 75%);
    background-color: transparent; background-size: 20px 20px; background-position: center center;
    animation: neonPulse 2s infinite ease-in-out;
    z-index: 10; flex-shrink: 0;
  }
  canvas#c { width: 310px; height: 310px; touch-action: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 15; }
  .ui { margin-top: 20px; width: 310px; display: flex; flex-direction: column; gap: 6px; }
  .btn { background: #111; border: 2px solid #ffffff; color: white; padding: 10px; text-align: center; border-radius: 8px; font-weight: bold; font-size: 12px; cursor: pointer; width: 100%; box-sizing: border-box; text-transform: uppercase; }
  .btn-r { border-color: #ff0000; }
  .lbl { font-size: 9px; color: #888; text-transform: uppercase; display: flex; justify-content: space-between; width: 100%; margin-top: 5px; }
  .val-tag { color: #ff0000; font-weight: bold; }

  /* --- GIF STUDIO (RESTORED LAYOUT) --- */
  @keyframes rotate { 100% { transform: rotate(360deg); } }
  .stage { position: relative; width: 320px; height: 320px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; }
  .led-ring { position: absolute; inset: -15px; border-radius: 50%; background: conic-gradient(from 0deg, #00f3ff, #bc13fe, #ff0055, #00f3ff); animation: rotate 2s linear infinite; filter: blur(15px); z-index: 1; }
  .viewport { position: relative; z-index: 5; width: 100%; height: 100%; border-radius: 50%; overflow: hidden; background: #000; display: flex; justify-content: center; align-items: center; box-shadow: inset 0 0 20px #000; }
  #v { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); will-change: transform; pointer-events: none; }
  #o { width: 100%; height: 100%; object-fit: contain; display: none; }
  
  .ui-gif { z-index: 10; background: rgba(10, 10, 10, 0.9); padding: 25px; border-radius: 30px; width: 340px; border: 1px solid rgba(255,255,255,0.1); box-sizing: border-box; display:flex; flex-direction:column; align-items:center; margin-bottom:20px; }
  .btn-upload { background: linear-gradient(90deg, #00f3ff, #bc13fe); color: #000; border: none; padding: 15px; border-radius: 50px; font-weight: 800; cursor: pointer; width: 100%; margin-bottom: 15px; }
  
  .neon-wrap { position: relative; display: block; margin-top: 15px; padding: 3px; border-radius: 50px; overflow: hidden; width: 100%; }
  .neon-wrap.blue::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: conic-gradient(transparent, transparent, #00f3ff, #bc13fe, #ff0055, #00f3ff, transparent, transparent); animation: rotate 3s linear infinite; z-index: 0; }
  .btn-inner { position: relative; display: block; text-align: center; color: white; background: #000; padding: 12px; border-radius: 48px; font-weight: 900; z-index: 1; cursor: pointer; width: 100%; border: none; font-size: 14px; }

  /* --- GRADIENT SLIDERS --- */
  input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; margin: 10px 0; cursor: pointer; }
  input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 8px; background: linear-gradient(to right, #ff0000 var(--v, 0%), #333 var(--v, 0%)); border-radius: 4px; }
  .ui-gif input[type=range]::-webkit-slider-runnable-track { background: linear-gradient(to right, #00ffff var(--v, 0%), #333 var(--v, 0%)); }
  input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 20px; width: 20px; border-radius: 50%; background: #fff; margin-top: -6px; border: 2px solid #ff0000; box-shadow: 0 0 10px #ff0000; }
  .ui-gif input[type=range]::-webkit-slider-thumb { border-color: #00ffff; box-shadow: 0 0 10px #00ffff; }

  /* --- FONTS & SYMBOLS --- */
  .font-input { width: 100%; background: #111; border: 2px solid #00ffff; color: #fff; padding: 15px; border-radius: 8px; text-align: center; margin-bottom: 15px; outline: none; box-sizing: border-box; }
  .font-scroll { width: 100%; max-height: 400px; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; box-sizing: border-box; }
  .font-item { background: #1a1a1c; border-bottom: 1px solid rgba(255,255,255,0.1); padding: 16px; text-align: center; cursor: pointer; white-space: pre-wrap; }
  .sym-grid { display: flex; flex-wrap: wrap; gap: 5px; padding: 10px; }
  .sym-btn { background: #1a1a1c; border: 1px solid #333; color: white; padding: 15px 0; font-size: 20px; border-radius: 6px; cursor: pointer; flex: 1 0 18%; text-align: center; }
  .cat-title { color: #ff0000; font-size: 12px; font-weight: bold; margin: 15px 10px 5px; text-transform: uppercase; border-bottom: 1px solid rgba(255,0,0,0.2); }

  input[type=file], #yt-player { display: none; }
</style>
</head>
<body onclick="handleGlobalClick(event)">

<div id="arcade-clock">00:00:00</div>

<button class="menu-toggle" onclick="toggleMenu(event)">MENU â˜°</button>
<button id="view-toggle" onclick="toggleViewMode()">ğŸ–¥ï¸</button>

<div id="menu-panel">
  <div class="menu-section">
    <div class="menu-lbl">Studio Selection</div>
    <div class="switch-container">
      <button id="switch-btn" onclick="toggleSwitchMenu(event)">SELECT TOOL ğŸ“‚</button>
      <div id="switch-menu">
        <button onclick="changeStudio('frame')">ğŸ–¼ï¸ Frame Studio</button>
        <button onclick="changeStudio('font')">âœï¸ Font Generator</button>
        <button onclick="changeStudio('gif')">âš¡ GIF Maker</button>
        <button onclick="changeStudio('sym')">âœ¨ Symbols Studio</button>
      </div>
    </div>
  </div>

  <div class="menu-section">
    <div class="menu-lbl">Music Player</div>
    <div onclick="toggleMusic()" style="display:flex; justify-content:space-between; font-size:12px; cursor:pointer;">
      <span>POWER</span> <span id="m-status" style="color:#ff0000;">ON</span>
    </div>
    <select id="track-select" style="width:100%; margin-top:5px; background:#222; color:white; border:1px solid #444;" onchange="changeMusic(this.value)">
      <option value="jfKfPfyJRdk">â˜• Lofi Focus</option>
      <option value="nv_2rz5BFDA">ğŸ•¹ï¸ Retro Wave</option>
    </select>
  </div>

  <div class="menu-section">
    <div class="menu-lbl">Button SFX</div>
    <select id="sfx-select" style="width:100%; background:#222; color:white; border:1px solid #444;">
      <option value="bit" selected>ğŸ‘¾ 8-Bit Tone</option>
      <option value="arcade">ğŸ•¹ï¸ Arcade Click</option>
      <option value="bubble">ğŸ«§ Soft Pop</option>
      <option value="switch">âŒ¨ï¸ Quiet Switch</option>
    </select>
  </div>

  <button class="btn" style="border-color:#00ffff; color:#00ffff;" onclick="showAbout()">ABOUT STUDIO â„¹ï¸</button>

  <a href="https://discord.gg/ardc" target="_blank" class="lnk" style="border-color:#5865F2;">
    <svg viewBox="0 0 127.14 96.36"><path d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.11,77.11,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22c2.36-24.44-5.42-48.18-18.9-72.15ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/></svg>
    <span>Discord Server</span>
  </a>

  <a href="https://platopedia.com/groups/arcade" target="_blank" class="lnk" style="border-color:#00ffff;">
    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
    <span>Arcade Website</span>
  </a>

  <div class="designed-by">DESIGNED BY <b>RISK</b></div>
</div>

<div id="about-overlay" onclick="hideAbout()">
    <div class="about-content" onclick="event.stopPropagation()">
        <span class="close-about" onclick="hideAbout()">âœ–</span>
        <h2 style="font-style:italic;">ARCADE STUDIO â„¹ï¸</h2>
        <p>A professional HUD built for the elite gaming community. <b>Arcade Studio</b> delivers high-speed creative tools for Discord profiles and tournament winners.</p>
        <p><b>âš¡ Engine:</b> HD GIF processor handles heavy video files with instant real-time encoding.</p>
        <p><b>ğŸ–¼ï¸ Logic:</b> Custom <b>Constraint Logic</b> ensures your profile frames are locked perfectly to the circle. No black gaps, ever.</p>
    </div>
</div>

<div id="yt-player"></div>

<h1 id="studio-name">ARCADE</h1>
<p class="sub" id="studio-sub">FRAME STUDIO</p>

<div id="frame-studio" class="studio-sec active-sec">
  <div id="box"><canvas id="c" width="800" height="800"></canvas></div>
  <div class="ui">
    <label class="btn">CHOOSE IMAGE<input type="file" id="u1" accept="image/*" onchange="handleFile(event)"></label>
    <label class="btn btn-r">APPLY FRAME<input type="file" id="u2" accept="image/*" onchange="handleFrame(event)"></label>
    <button class="btn" style="border-color:#00ffff; color:#00ffff;" onclick="centerSubject()">CENTER SUBJECT ğŸ¯</button>
    <button class="btn" style="border-color:#ff0000; color:#ff0000;" onclick="resetProject()">RESET PROJECT â†»</button>
    <div class="lbl">ZOOM <span id="z-val" class="val-tag">100%</span></div>
    <input type="range" id="z" min="0.1" max="4" step="0.01" value="1" oninput="updateZ(this.value)">
    <div class="lbl">ROTATE <span id="r-val" class="val-tag">0Â°</span></div>
    <input type="range" id="r" min="0" max="360" step="1" value="0" oninput="updateR(this.value)">
    <button id="save" class="btn" onclick="downloadPic()" disabled>DOWNLOAD PICTURE</button>
  </div>
</div>

<div id="font-studio" class="studio-sec">
  <input type="text" id="font-input" class="font-input" placeholder="Type text here..." oninput="genFonts()">
  <div id="font-results" class="font-scroll"></div>
</div>

<div id="gif-studio" class="studio-sec">
    <div class="stage" id="stage">
        <div class="led-ring"></div>
        <div class="viewport" id="vp">
            <video id="v" muted playsinline loop></video>
            <img id="o">
        </div>
    </div>
    <div class="ui-gif">
        <button class="btn-upload" onclick="document.getElementById('gfInput').click()">UPLOAD VIDEO</button>
        <input type="file" id="gfInput" accept="video/*" style="display:none">
        
        <div class="lbl" style="width:100%">ZOOM / SCALE <span id="zv" class="val-tag">100%</span></div>
        <input type="range" id="zoom" min="100" max="300" step="1" value="100" oninput="updateGifZ(this.value)">
        
        <div class="lbl" style="width:100%">SPEED <span id="sv" class="val-tag">1.0x</span></div>
        <input type="range" id="speed" min="0.5" max="3.0" step="0.1" value="1.0" oninput="updateGifS(this.value)">
        
        <div class="neon-wrap blue"><button id="go" class="btn-inner" onclick="processGif()">âš¡ CREATE HD GIF</button></div>
        <div id="msg" style="text-align:center; font-size:11px; color:#00ffff; margin-top:5px;">Ready</div>
        <div id="dlBox" class="neon-wrap blue" style="display:none; margin-top:10px;"><a id="dl" class="btn-inner">â¬‡ï¸ DOWNLOAD GIF</a></div>
    </div>
</div>

<div id="sym-studio" class="studio-sec">
    <input type="text" id="sym-box" class="font-input" placeholder="Build your bio here...">
    <div id="sym-container" class="font-scroll"></div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
const c=document.getElementById('c'),x=c.getContext('2d'),zSl=document.getElementById('z'),rSl=document.getElementById('r'),panel=document.getElementById('menu-panel'),mStat=document.getElementById('m-status'), sName=document.getElementById('studio-name'), sSub=document.getElementById('studio-sub'), swMenu=document.getElementById('switch-menu');
const zVal=document.getElementById('z-val'),rVal=document.getElementById('r-val');
let i=new Image(),f=new Image(),cfg={s:1,m:375,x:400,y:400,r:0},player,musicOn=true,audioStarted=false;
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

// --- CLOCK ---
function updateClock(){ document.getElementById('arcade-clock').innerText = new Date().toTimeString().split(' ')[0]; }
setInterval(updateClock, 1000); updateClock();

// --- GLOBAL HANDLER (MENU + RIPPLE ONLY) ---
function handleGlobalClick(e) {
    if(!audioStarted) initAudio();
    if(panel.classList.contains('open') && !panel.contains(e.target) && !e.target.classList.contains('menu-toggle')) panel.classList.remove('open');
    if(swMenu.style.display==='flex' && !e.target.closest('.switch-container')) swMenu.style.display='none';
    playClick();
    
    // Ripple FX Only (No fire/bullets)
    const rip = document.createElement("div"); rip.className = "ripple";
    let col = "#ff0000"; if(musicOn && player){ const t=document.getElementById('track-select').value; if(t==='jfKfPfyJRdk')col="#ffffff"; if(t==='nv_2rz5BFDA')col="#00ffff"; }
    rip.style.borderColor=col; rip.style.boxShadow=`0 0 15px ${col}`;
    rip.style.left=e.clientX-25+"px"; rip.style.top=e.clientY-25+"px"; rip.style.width=rip.style.height="50px";
    document.body.appendChild(rip); rip.onanimationend=()=>rip.remove();
}

// --- AUDIO ---
function initAudio(){ if(!audioStarted){ audioCtx.resume().then(()=>{ audioStarted=true; if(player&&musicOn){ player.unMute(); player.playVideo(); }});}}
function playClick(){
    if(!audioStarted) return; const type=document.getElementById('sfx-select').value;
    const o=audioCtx.createOscillator(), g=audioCtx.createGain(); o.connect(g); g.connect(audioCtx.destination);
    if(type==='bit'){ o.type='sawtooth'; o.frequency.setValueAtTime(120, audioCtx.currentTime); g.gain.setValueAtTime(0.02, audioCtx.currentTime); }
    else if(type==='arcade'){ o.frequency.setValueAtTime(600, audioCtx.currentTime); g.gain.setValueAtTime(0.03, audioCtx.currentTime); }
    else if(type==='bubble'){ o.type='sine'; o.frequency.setValueAtTime(400, audioCtx.currentTime); g.gain.setValueAtTime(0.02, audioCtx.currentTime); }
    else { o.type='square'; o.frequency.setValueAtTime(150, audioCtx.currentTime); g.gain.setValueAtTime(0.01, audioCtx.currentTime); }
    o.start(); o.stop(audioCtx.currentTime+0.1);
}
function onYouTubeIframeAPIReady(){ player=new YT.Player('yt-player',{height:'0',width:'0',videoId:'jfKfPfyJRdk',playerVars:{'autoplay':1,'loop':1,'playlist':'jfKfPfyJRdk'},events:{'onReady':e=>{e.target.setVolume(25);}}});}
function changeMusic(id){ if(player)player.loadVideoById(id); }
function toggleMusic(){ initAudio(); musicOn=!musicOn; if(musicOn){ player.playVideo(); mStat.innerText="ON"; mStat.style.color="#ff0000"; }else{ player.pauseVideo(); mStat.innerText="OFF"; mStat.style.color="#888"; }}

// --- FONTS (FULL 38) ---
const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
const alphas = [
  {m:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ğ€ğğ‚ğƒğ„ğ…ğ†ğ‡ğˆğ‰ğŠğ‹ğŒğğğğğ‘ğ’ğ“ğ”ğ•ğ–ğ—ğ˜ğ™ğšğ›ğœğğğŸğ ğ¡ğ¢ğ£ğ¤ğ¥ğ¦ğ§ğ¨ğ©ğªğ«ğ¬ğ­ğ®ğ¯ğ°ğ±ğ²ğ³ğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ”ğŸ•ğŸ–ğŸ—"},
  {m:"ğ´ğµğ¶ğ·ğ¸ğ¹ğºğ»ğ¼ğ½ï¼«ï¼¬ï¼­ğ‘ğ‘‚ğ‘ƒğ‘„ğ‘…ğ‘†ğ‘‡ğ‘ˆâ“‹ğ‘Šğ‘‹ğ‘Œğ‘ğ‘ğ‘ï½ƒï½„ï½…ï½†ï½‡ï½ˆï½‰ğ‘—ï½‹ï½Œï½ï½ï½ï½ğ‘ğ‘Ÿğ‘ ğ‘¡ğ‘¢ğ‘£ğ‘¤ğ‘¥ï½™ï½š0123456789"},
  {m:"ğ‘¨ğ‘©ğ‘ªğ‘«ğ‘¬ğ‘­ğ‘®ğ‘¯ğ‘°ğ‘±ğ‘²ğ‘³ğ‘´ğ‘µğ‘¶ğ‘·ğ‘¸ğ‘¹ğ‘ºğ‘»ğ‘¼â“‹ğ‘¾ğ‘¿ğ’€ğ’ğ’‚ğ’ƒğ’„ğ’…ğ’†ğ’‡ğ’ˆğ’‰ğ’Šğ’‹ğ’Œğ’ğ’ğ’ğ’ğ’‘ğ’’ğ’“ğ’”ğ’•ğ’–ğ’—ğ’˜ğ’™ğ’šğ’›ğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ”ğŸ•ğŸ–ğŸ—"},
  {m:"ğ’œâ„¬ğ’ğ’Ÿâ„°â„±ğ’¢â„‹â„ğ’¥ğ’¦â„’â„³â’©â’ªâ’«â’¬â„›ğ’®ğ’¯ğ’°â“‹ğ’²ğ’³ğ’´ğ’µğ’¶ğ’·ğ’¸ğ’¹â„¯ğ’»â„Šğ’½ğ’¾ğ’¿ğ“€ğ“ğ“‚ğ“ƒâ„´ğ“…ğ“†ğ“‡ğ“ˆğ“‰ğ“Šâ“‹ğ“Œğ“ğ“ğ“0123456789"},
  {m:"ğ“ğ“‘ğ“’ğ““ğ“”ğ“•ğ“–ğ“—ğ“˜ğ“™ğ“šğ“›ğ“œğ“ğ“ğ“Ÿğ“ ğ“¡ğ“¢ğ“£ğ“¤â“‹ğ“¦ğ“§ğ“¨ğ“©ğ“ªğ“«ğ“¬ğ“­ğ“®ğ“¯ğ“°ğ“±ğ“²ğ“³ğ“´ğ“µğ“¶ğ“·ğ“¸ğ“¹ğ“ºğ“»ğ“¼ğ“½ğ“¾ğ“‹¼ğ”€ğ”ğ”‚ğ”ƒ0123456789"},
  {m:"ğ– ğ–¡ğ–¢ğ–£ğ–¤ğ–¥ğ–¦ğ–§ğ–¨ğ–©ğ–ªğ–«ğ–¬ğ–­ğ–®ğ–¯ğ–°ğ–±ğ–²ğ–³ğ–´â“‹ğ–‚ğ–ƒğ–„ğ–…ğ–ºğ–»ğ–¼ğ–½ğ–¾ğ–¿ğ—€ğ—ğ—‚ğ—ƒğ—„ğ—…ğ—†ğ—‡ğ—ˆğ—‰ğ—Šğ—‹ğ—Œğ—ğ—â“‹ğ—ğ—‘ğ—’ğ—“ğŸ¢ğŸ£ğŸ¤ğŸ¥ğŸ¦ğŸ§ğŸ¨ğŸ©ğŸªğŸ«"},
  {m:"ğ—”ğ—•ï¼£ğ——ğ—˜ğ—™ğ—šï¼¨ï¼©ï¼ªï¼«ï¼¬ï¼­ï¼®ï¼¯ï¼°ğ—¤ğ—¥ğ—¦ï¼´ğ—¨â“‹ğ—ªğ—«ï¼¹ğ—­ğ—®ğ—¯ï½ƒï½„ï½…ï½†ï½‡ğ—µï½‰ğ‘—ï½‹ï½Œï½ï½ï½ï½ğ—¾ï½’ï½“ï½”ï½•ï½–ï½—ğ˜…ï½™ï½šğŸ¬ğŸ­ğŸ®ğŸ¯ğŸ°ğŸ±ğŸ²ğŸ³ğŸ´ğŸµ"},
  {m:"ğ”¸ğ”¹â„‚ğ”»ğ”¼ğ”½ğ”¾â„ğ•€ğ•ğ•‚ğ•ƒğ•„â„•ğ•†â„™â„šâ„ğ•Šğ•‹ğ•Œğ•ğ•ğ•ğ•â„¤ğ•’ğ•“ğ•”ğ••ğ•–ğ•—ğ•˜ğ•™ï½‰ğ‘—ï½‹ï½Œï½ï½ï½ï½ğ•¢ï½’ï½“ï½”ï½•ğ“‹¼ğ•¨ğ•©ğ•ªğ•«ğŸ˜ğŸ™ğŸšğŸ›ğŸœğŸğŸğŸŸğŸ ğŸ¡"},
  {m:"ğ”„ğ”…â„­ğ”‡ğ”ˆğ”‰ğ”Šâ„Œâ„‘ğ”ğ”ğ”ğ”ğ”‘ğ”’ğ”“ğ””â„œğ”–ğ”—ğ”˜ğ”™ğ”šğ”›ğ”œâ„¨ğ”ğ”Ÿğ” ğ”¡ğ”¢ğ”£ğ”¤ï½ˆï½‰ğ‘—ï½‹ï½Œï½ï½ï½ï½ğ”®ï½’ï½“ï½”ï½•ğ“‹¼ğ”´ğ”µğ”¶ğ”·0123456789"},
  {m:"ğ•¬ğ•­ğ•®ğ•¯ğ•°ğ•±ğ•²ğ•³ğ•´ğ•µğ•¶ğ•·ğ•¸ğ•¹ğ•ºğ•»ğ•¼ğ•½ğ•¾ğ•¿ğ–€ğ–ğ–‚ğ–ƒğ–„ğ–…ğ–†ğ–‡ğ–ˆğ–‰ğ–Šğ–‹ğ–Œğ–ğ–ğ–ğ–ğ–‘ğ–’ğ–“ğ–”ğ–•ğ––ğ–—ğ–˜ğ–™ğ–šğ“‹¼ğ–œğ–ğ–ğ–Ÿ0123456789"},
  {m:"â‚³à¸¿â‚µÄÉ†â‚£â‚²â±§Å‚Jâ‚­â± â‚¥â‚¦Ã˜â‚±Qâ±¤â‚´â‚®É„Vâ‚©Ó¾Éâ±«â‚³à¸¿â‚µÄÉ†â‚£â‚²â±§Å‚Jâ‚­â± â‚¥â‚¦Ã˜â‚±Qâ±¤â‚´â‚®É„Vâ‚©Ó¾Éâ±«0123456789"},
  {m:"ÈºÆ€Ã§ÄÉ‡fÇ¤Ä§É¨É‰êÅ‚mNÃ¸áµ½ê—ÉsÅ§áµ¾vwxyÆµÈºÆ€Ã§ÄÉ‡fÇ¤Ä§É¨É‰êÅ‚mNÃ¸áµ½ê—ÉsÅ§áµ¾vwxyÆµ0123456789"},
  {m:"Î±Ğ²câˆ‚Ñ”Æ’gĞ½Î¹× Ğºâ„“Ğ¼Ğ¸ÏƒÏqÑÑ•Ñ‚Ï…Î½Ï‰Ï‡ÑƒzÎ±Ğ²câˆ‚Ñ”Æ’gĞ½Î¹× Ğºâ„“Ğ¼Ğ¸ÏƒÏqÑÑ•Ñ‚Ï…Î½Ï‰Ï‡Ñƒz0123456789"},
  {m:"Î›Bá„ƒDÎ£FGÎ‰IJKLMĞŸÓ¨PQĞ¯Æ§Æ¬Ğ¦VĞ©XYZÎ›Bá„ƒDÎ£FGÎ‰IJKLMĞŸÓ¨PQĞ¯Æ§Æ¬Ğ¦VĞ©XYZ0123456789"},
  {m:"Ğ”Ğ‘CDÎFGHÅ‚JÒœLMĞ˜Ğ¤PÇªĞ¯SÎ“Ğ¦VĞ©XYZĞ´ÑŠcdÎ¾fgĞ½Î¹jÎºlĞ¼nÃ¸pqÑsÑ‚Ñ†vÏ‰xÑ‡z0123456789"},
  {m:"ï¾‘ä¹ƒcdä¹‡fGã‚“ï¾‰jã‚ºlmåˆ€oï½±qå°ºsï½²uâˆšwï¾’ï¾˜zï¾‘ä¹ƒcdä¹‡fGã‚“ï¾‰jã‚ºlmåˆ€oï½±qå°ºsï½²uâˆšwï¾’ï¾˜z0123456789"},
  {m:"[A][B][C][D][E][F][G][H][I][J][K][L][M][N][O][P][Q][R][S][T][U][V][W][X][Y][Z][a][b][c][d][e][f][g][h][i][j][k][l][m][n][o][p][q][r][s][t][u][v][w][x][y][z][0][1][2][3][4][5][6][7][8][9]"},
  {m:"{A}{B}{C}{D}{E}{F}{G}{H}{I}{J}{K}{L}{M}{N}{O}{P}{Q}{R}{S}{T}{U}{V}{W}{X}{Y}{Z}{a}{b}{c}{d}{e}{f}{g}{h}{i}{j}{k}{l}{m}{n}{o}{p}{q}{r}{s}{t}{u}{v}{w}{x}{y}{z}{0}{1}{2}{3}{4}{5}{6}{7}{8}{9}"},
  {m:"<A><B><C><D><E><F><G><H><I><J><K><L><M><N><O><P><Q><R><S><T><U><V><W><X><Y><Z><a><b><c><d><e><f><g><h><i><j><k><l><m><n><o><p><q><r><s><t><u><v><w><x><y><z><0><1><2><3><4><5><6><7><8><9>"},
  {m:"(A)(B)(C)(D)(E)(F)(G)(H)(I)(J)(K)(L)(M)(N)(O)(P)(Q)(R)(S)(T)(U)(V)(W)(X)(Y)(Z)(a)(b)(c)(d)(e)(f)(g)(h)(i)(j)(k)(l)(m)(n)(o)(p)(q)(r)(s)(t)(u)(v)(w)(x)(y)(z)(0)(1)(2)(3)(4)(5)(6)(7)(8)(9)"},
  {m:"â™¥Aâ™¥Bâ™¥Câ™¥Dâ™¥Eâ™¥Fâ™¥Gâ™¥Hâ™¥Iâ™¥Jâ™¥Kâ™¥Lâ™¥Mâ™¥Nâ™¥Oâ™¥Pâ™¥Qâ™¥Râ™¥Sâ™¥Tâ™¥Uâ™¥Vâ™¥Wâ™¥Xâ™¥Yâ™¥Zâ™¥aâ™¥bâ™¥câ™¥dâ™¥eâ™¥fâ™¥gâ™¥hâ™¥iâ™¥jâ™¥kâ™¥lâ™¥mâ™¥nâ™¥oâ™¥pâ™¥qâ™¥râ™¥sâ™¥tâ™¥uâ™¥vâ™¥wâ™¥xâ™¥yâ™¥zâ™¥0â™¥1â™¥2â™¥3â™¥4â™¥5â™¥6â™¥7â™¥8â™¥9"},
  {m:"â˜…Aâ˜…Bâ˜…Câ˜…Dâ˜…Eâ˜…Fâ˜…Gâ˜…Hâ˜…Iâ˜…Jâ˜…Kâ˜…Lâ™¥Mâ™¥Nâ™¥Oâ™¥Pâ™¥Qâ™¥Râ™¥Sâ˜…Tâ˜…Uâ˜…Vâ˜…Wâ˜…Xâ˜…Yâ˜…Zâ˜…aâ˜…bâ˜…câ˜…dâ˜…eâ˜…fâ˜…gâ˜…hâ˜…iâ˜…jâ˜…kâ˜…lâ˜…mâ˜…nâ˜…oâ˜…pâ˜…qâ˜…râ˜…sâ˜…tâ˜…uâ˜…vâ˜…wâ˜…xâ˜…yâ˜…zâ˜…0â˜…1â˜…2â˜…3â˜…4â˜…5â˜…6â˜…7â˜…8â˜…9"},
  {m:"Aâ‹†Bâ‹†Câ‹†Dâ‹†Eâ‹†Fâ‹†Gâ‹†Hâ‹†Iâ‹†Jâ‹†Kâ‹†Lâ‹†Mâ‹†Nâ‹†Oâ‹†Pâ‹†Qâ‹†Râ‹†Sâ‹†Tâ‹†Uâ‹†Vâ‹†Wâ‹†Xâ‹†Yâ‹†Zâ‹†aâ‹†bâ‹†câ‹†dâ‹†eâ‹†fâ‹†gâ‹†hâ‹†iâ‹†jâ‹†kâ‹†lâ‹†mâ‹†nâ‹†oâ‹†pâ‹†qâ‹†râ‹†sâ‹†tâ‹†uâ‹†vâ‹†wâ‹†xâ‹†yâ‹†zâ‹†0â‹†1â‹†2â‹†3â‹†4â‹†5â‹†6â‹†7â‹†8â‹†9"},
  {m:"A.B.C.D.E.F.G.H.I.J.K.L.M.N.O.P.Q.R.S.T.U.V.W.X.Y.Z.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.x.y.z.0.1.2.3.4.5.6.7.8.9"},
  {m:"AÌ²BÌ²CÌ²DÌ²EÌ²FÌ²GÌ²HÌ²IÌ²JÌ²KÌ²LÌ²MÌ²NÌ²OÌ²PÌ²QÌ²RÌ²SÌ²TÌ²UÌ²VÌ²WÌ²XÌ²YÌ²ZÌ²aÌ²bÌ²cÌ²dÌ²eÌ²fÌ²gÌ²hÌ²iÌ²jÌ²kÌ²lÌ²mÌ²nÌ²oÌ²pÌ²qÌ²rÌ²sÌ²tÌ²uÌ²vÌ²wÌ²xÌ²yÌ²zÌ²0Ì²1Ì²2Ì²3Ì²4Ì²5Ì²6Ì²7Ì²8Ì²9"},
  {m:"AÌ¶BÌ¶CÌ¶DÌ¶EÌ¶FÌ¶GÌ¶HÌ¶IÌ¶JÌ¶KÌ¶LÌ¶MÌ¶NÌ¶OÌ¶PÌ¶QÌ¶RÌ¶SÌ¶TÌ¶UÌ¶VÌ¶WÌ¶XÌ¶YÌ¶ZÌ¶aÌ¶bÌ¶cÌ¶dÌ¶eÌ¶fÌ¶gÌ¶hÌ¶iÌ¶j_kÌ¶lÌ¶mÌ¶nÌ¶oÌ¶pÌ¶qÌ¶rÌ¶sÌ¶tÌ¶uÌ¶vÌ¶wÌ¶xÌ¶yÌ¶zÌ¶0Ì¶1Ì¶2Ì¶3Ì¶4Ì¶5Ì¶6Ì¶7Ì¶8Ì¶9"},
  {m:"ğŸ„ğŸ„‘ğŸ„’ğŸ„“ğŸ„”ğŸ„•ğŸ„–ğŸ„—ğŸ„˜ğŸ„™ğŸ„šğŸ„›ğŸ„œğŸ„ğŸ„ğŸ„ŸğŸ„ ğŸ„¡ğŸ„¢ğŸ„£ğŸ„¤ğŸ„¥ğŸ„¦ğŸ„§ğŸ„¨ğŸ„©ğŸ„ğŸ„‘ğŸ„’ğŸ„“ğŸ„”ğŸ„•ğŸ„–ğŸ„—ğŸ„˜ğŸ„™ğŸ„šğŸ„›ğŸ„œğŸ„ğŸ„ğŸ„ŸğŸ„ ğŸ„¡ğŸ„¢ğŸ„£ğŸ„¤ğŸ„¥ğŸ„¦ğŸ„§ğŸ„¨ğŸ„©0123456789"},
  {m:"â“â“‘â“’â““â“”â“•â“–â“—â“˜â“™â“šâ“›â“œâ“â“â“Ÿâ“ â“¡â“¢â“£â“¤â“¥â“¦â“§â“¨â“©â“â“‘â“’â““â“”â“•â“–â“—â“˜â“™â“šâ“›â“œâ“â“â“Ÿâ“ â“¡â“¢â“£â“¤â“¥â“¦â“§â“¨â“©0123456789"},
  {m:"ğŸ„°ğŸ„±ğŸ„²ğŸ„³ğŸ„´ğŸ„µğŸ„¶ğŸ„·ğŸ„¸ğŸ„¹ğŸ„ºğŸ„»ğŸ„¼ğŸ„½ğŸ„¾ğŸ„¿ğŸ…€ğŸ…ğŸ…‚ğŸ…ƒğŸ…„ğŸ……ğŸ…†ğŸ…‡ğŸ…ˆğŸ…‰ğŸ„°ğŸ„±ğŸ„²ğŸ„³ğŸ„´ğŸ„µğŸ„¶ğŸ„·ğŸ„¸ğŸ„¹ğŸ„ºğŸ„»ğŸ„¼ğŸ„½ğŸ„¾ğŸ„¿ğŸ…€ğŸ…ğŸ…‚ğŸ…ƒğŸ…„ğŸ……ğŸ…†ğŸ…‡ğŸ…ˆğŸ…‰0123456789"}
];

function genFonts(){
  const v=document.getElementById('font-input').value, b=document.getElementById('font-results'); b.innerHTML=""; if(!v) return;
  alphas.forEach(a => {
    let t = ""; const m = Array.from(a.m);
    for(let c of v){ let idx = chars.indexOf(c); t += (idx !== -1 && m[idx]) ? m[idx] : c; }
    let d=document.createElement('div'); d.className="font-item"; d.innerText=t; d.onclick=()=>{navigator.clipboard.writeText(t);}; b.appendChild(d);
  });
}

function renderSymbols(){
    const b = document.getElementById('sym-container'); b.innerHTML = "";
    const s = { "Hearts": ["â¤","â¥","â™¡","â™¥","â¦","â§","â£","ğŸ’","ğŸ’—","ğŸ’•","ğŸ’˜","ğŸ’","ğŸ’Ÿ","ğŸ’Œ","ğŸ’‹"], "Stars": ["âœ¨","â˜…","â˜†","âœ¡","âœ¦","âœ§","âœ©","âœª","âœ«","âœ¬","âœ­","âœ®","âœ¯","âœ°","â‚","â„","â…","â†"], "Dice": ["ğŸ²","âš€","âš","âš‚","âšƒ","âš„","âš…"], "Arrows": ["â†","â†‘","â†’","â†“","â†”","â†•","â†º","â†»","â†–","â†—","â†˜","â†™"] };
    for (const [c, y] of Object.entries(s)) {
        let t = document.createElement('div'); t.className = "cat-title"; t.innerText = c; b.appendChild(t);
        let g = document.createElement('div'); g.className = "sym-grid";
        y.forEach(i => { let n = document.createElement('div'); n.className = "sym-btn"; n.innerText = i; n.onclick = () => { document.getElementById('sym-box').value += i; }; g.appendChild(n); }); b.appendChild(g);
    }
}
renderSymbols();

// --- RESTORED GIF ENGINE + DRAG LOGIC ---
const wB = new Blob([`importScripts('https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.worker.js');`], { type: 'application/javascript' });
const wU = URL.createObjectURL(wB);
const gfI=document.getElementById('gfInput'), v=document.getElementById('v'), o=document.getElementById('o'), go=document.getElementById('go'), msg=document.getElementById('msg');
let gX=0, gY=0;

gfI.onchange=(e)=>{ const f=e.target.files[0]; if(!f)return; v.style.display='block'; o.style.display='none'; v.src=URL.createObjectURL(f); v.onloadedmetadata=()=>v.play(); };

function processGif() {
  if(!v.src) return; document.getElementById('go').disabled=true; msg.innerText="Processing...";
  const gif=new GIF({workers:2, quality:10, width:480, height:480, workerScript:wU});
  const can=document.createElement('canvas'); can.width=480; can.height=480; const ctx=can.getContext('2d');
  let cT=0; const fps=15;
  const cap=()=>{ if(cT>=v.duration){ msg.innerText="Encoding..."; gif.render(); return; } v.currentTime=cT; };
  v.onseeked=()=>{ 
      const scale = parseInt(document.getElementById('zoom').value) / 100;
      let drawW, drawH;
      const aspect = v.videoWidth / v.videoHeight;
      if(aspect > 1) { drawH = 480; drawW = 480 * aspect; } else { drawW = 480; drawH = 480 / aspect; }
      drawW *= scale; drawH *= scale;
      const dragScale = 480 / 320;
      const dx = (480 - drawW) / 2 + (gX * dragScale);
      const dy = (480 - drawH) / 2 + (gY * dragScale);
      ctx.fillStyle='#000'; ctx.fillRect(0,0,480,480);
      ctx.drawImage(v, dx, dy, drawW, drawH); 
      gif.addFrame(ctx,{copy:true, delay:1000/fps}); cT+=(1/fps); setTimeout(cap, 10); 
  };
  gif.on('finished', b=>{ const url=URL.createObjectURL(b); v.style.display='none'; o.src=url; o.style.display='block'; document.getElementById('dl').href=url; document.getElementById('dlBox').style.display='block'; msg.innerText="Ready"; document.getElementById('go').disabled=false; });
  cap();
}

function updateGifZ(val) { document.getElementById('zv').innerText = val + '%'; updateGifTransform(); }
function updateGifS(val) { document.getElementById('sv').innerText = val + 'x'; v.playbackRate = parseFloat(val); }

function updateGifTransform() {
    if(!v.src) return;
    const z = parseInt(document.getElementById('zoom').value) / 100;
    v.style.transform = `translate(calc(-50% + ${gX}px), calc(-50% + ${gY}px)) scale(${z})`;
}

// --- GIF DRAG EVENT LISTENERS (RESTORED) ---
const vp = document.getElementById('vp');
let isGifDrag = false, startX, startY, initX, initY;
vp.addEventListener('mousedown', e => { if(!v.src) return; isGifDrag = true; startX = e.clientX; startY = e.clientY; initX = gX; initY = gY; });
vp.addEventListener('touchstart', e => { if(!v.src) return; isGifDrag = true; startX = e.touches[0].clientX; startY = e.touches[0].clientY; initX = gX; initY = gY; }, {passive:false});
window.addEventListener('mousemove', e => { if(!isGifDrag) return; gX = initX + (e.clientX - startX); gY = initY + (e.clientY - startY); updateGifTransform(); });
window.addEventListener('touchmove', e => { if(!isGifDrag) return; e.preventDefault(); gX = initX + (e.touches[0].clientX - startX); gY = initY + (e.touches[0].clientY - startY); updateGifTransform(); }, {passive:false});
window.addEventListener('mouseup', () => isGifDrag = false);
window.addEventListener('touchend', () => isGifDrag = false);

// --- FRAME ENGINE (RESTORED CONSTRAINT LOGIC) ---
function d(){ 
  x.clearRect(0,0,800,800); 
  if(i.src) {
     let w=i.width*cfg.s, h=i.height*cfg.s, m=Math.min(w, h), dist=(m>800)?(m-800)/2:0;
     if(cfg.x<400-dist)cfg.x=400-dist; if(cfg.x>400+dist)cfg.x=400+dist;
     if(cfg.y<400-dist)cfg.y=400-dist; if(cfg.y>400+dist)cfg.y=400+dist;
  }
  x.save(); x.beginPath(); x.arc(400,400,375,0,6.28); x.clip(); 
  if(i.src){ x.save(); x.translate(cfg.x,cfg.y); x.rotate(cfg.r*Math.PI/180); x.drawImage(i,-i.width*cfg.s/2,-i.height*cfg.s/2,i.width*cfg.s,i.height*cfg.s); x.restore(); } 
  x.restore(); if(f.src) x.drawImage(f,0,0,800,800); 
}
function handleFile(e){ let r=new FileReader(); r.onload=v=>{ let n=new Image(); n.onload=()=>{ i=n; cfg.s=Math.max(800/i.width, 800/i.height); cfg.x=400; cfg.y=400; cfg.r=0; zSl.min=cfg.s; zSl.value=cfg.s; d(); document.getElementById('save').disabled = false; }; n.src=v.target.result; }; r.readAsDataURL(e.target.files[0]); }
function handleFrame(e){ let r=new FileReader(); r.onload=v=>{ let n=new Image(); n.onload=()=>{f=n; d();}; n.src=v.target.result; }; r.readAsDataURL(e.target.files[0]); }
function updateZ(v){ cfg.s=parseFloat(v); d(); }
function updateR(v){ cfg.r=parseInt(v); d(); }
function centerSubject(){ cfg.x=400; cfg.y=400; cfg.r=0; d(); }
function resetProject(){ i=new Image(); f=new Image(); cfg={s:1,x:400,y:400,r:0}; d(); }
function downloadPic(){ d(); let a=document.createElement('a'); a.download=`Arcade_${Date.now()}.png`; a.href=c.toDataURL(); a.click(); }

// --- HELPERS ---
function toggleMenu(e){ e.stopPropagation(); panel.classList.toggle('open'); }
function toggleSwitchMenu(e){ e.stopPropagation(); swMenu.style.display = swMenu.style.display==='flex'?'none':'flex'; }
function toggleViewMode(){ document.body.classList.toggle('pc-mode'); }
function showAbout(){ document.getElementById('about-overlay').style.display='flex'; }
function hideAbout(){ document.getElementById('about-overlay').style.display='none'; }
function changeStudio(m) { 
    document.querySelectorAll('.studio-sec').forEach(s => s.classList.remove('active-sec'));
    document.getElementById(m+'-studio').classList.add('active-sec');
    sName.innerText = m.toUpperCase(); sSub.innerText = m==='frame'?'FRAME STUDIO':m==='font'?'GENERATOR':'STUDIO';
    panel.classList.remove('open');
}

// --- SLIDER COLOR UPDATER ---
document.querySelectorAll('input[type=range]').forEach(s => {
    const u = () => s.style.setProperty('--v', (s.value-s.min)/(s.max-s.min)*100+'%');
    s.addEventListener('input', u); u();
});

let isP=false, tStart={x:0,y:0};
c.onmousedown=e=>{isP=true; tStart={x:e.offsetX,y:e.offsetY};}
c.onmousemove=e=>{ if(!isP)return; cfg.x += (e.offsetX - tStart.x) * (800/310); cfg.y += (e.offsetY - tStart.y) * (800/310); tStart={x:e.offsetX,y:e.offsetY}; d(); }
window.onmouseup=()=>{isP=false;}
</script>
</body>
</html>
